/-
Copyright (c) 2025 ZKLib Contributors. All rights reserved.
Released under Apache 2.0 license as described in the file LICENSE.
Authors: Least Authority
-/
\chapter{Tools for Reed-Solomon codes}

\section{Random linear combination as a proximity generator}\label{sec:proximity_gap}


\begin{theorem}\label{thm:proximity_gap}
\lean{proximity_gap}
\leanok
\uses{def:rscode,def:smooth_dom}
    Let $\code := \rscode[\field,\evaldomain,\degree]$ be a Reed-Solomon code with rate $\rate:=\frac{\degree}{|\evaldomain|}$ and let $B'(\rate):=\sqrt{\rate}$. For every $\distance \in (0,1 - B'(\rate))$ and functions $f_1,\ldots,f_m : \evaldomain \to \field$, if
    \[
    \Pr_{r\leftarrow\field}\!\Bigl[
      \Delta\Bigl(\sum_{j=1}^m r^{j - 1}\cdot {f_j},\rscode[\field,\evaldomain,\degree]\Bigr)
      \le \delta
    \Bigr]>\err'(\degree,\rate,\distance,m),
    \]
    then there exists a subset $S \subseteq \evaldomain$ with $|S| \ge (1 - \delta)\cdot|L|$,
    and for every $i \in [m]$, there exists $u \in \rscode[\field,\evaldomain,\degree]$ such that $f_i(S) = u(S)$.
    
    \medskip
    
    \noindent
    Above, $\err'(\degree,\rate,\distance,m)$ is defined as follows:
    \begin{itemize}
        \item if $\distance \in \left(0,\frac{1-\rate}{2}\right]$ then
            \[
                \err'(\degree,\rate,\distance,m)=\frac{(m-1)\cdot \degree}{\rate\cdot|\field|}
            \]
        \item if $\distance \in \Bigl(\frac{1-\rate}{2}, 1-\sqrt{\rate}\Bigr)$ then
        \[
            \err'(\degree,\rate,\distance,m)=\frac{(m-1)\cdot {\degree}^2}{|\field|\cdot{\Bigl(2\cdot\min{1-\sqrt{\rate}-\distance,\frac{\sqrt{\rate}}{20}}\Bigr)}^7}
        \]
    \end{itemize}
    \end{theorem}
    